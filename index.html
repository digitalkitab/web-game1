<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Game Login</title>

<!-- ✅ SAFE CSS LINK -->
<link rel="stylesheet" href="./home.css">

</head>
<body>

<div class="box" id="loginBox">
  <h2>LOGIN</h2>
  <input id="lu" placeholder="Username">
  <input id="lp" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <div class="link" onclick="showSignup()">Create Account</div>
  <div class="link" onclick="showForgot()">Forgot Password</div>
  <div id="lm"></div>
</div>

<div class="box hidden" id="signupBox">
  <h2>CREATE ACCOUNT</h2>
  <input id="su" placeholder="Username">
  <input id="sp" type="password" placeholder="Password">
  <button onclick="signup()">Sign Up</button>
  <div class="link" onclick="showLogin()">Back</div>
  <div id="sm"></div>
</div>

<div class="box hidden" id="forgotBox">
  <h2>FORGOT PASSWORD</h2>
  <input id="fu" placeholder="Username">
  <button onclick="forgot()">Send Request</button>
  <div class="link" onclick="showLogin()">Back</div>
  <div id="fm"></div>
</div>

<script>
const API = "https://web-game-backend-18mn.onrender.com";

function showLogin(){
  document.getElementById("loginBox").classList.remove("hidden");
  document.getElementById("signupBox").classList.add("hidden");
  document.getElementById("forgotBox").classList.add("hidden");
}

function showSignup(){
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("signupBox").classList.remove("hidden");
  document.getElementById("forgotBox").classList.add("hidden");
}

function showForgot(){
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("signupBox").classList.add("hidden");
  document.getElementById("forgotBox").classList.remove("hidden");
}

async function login(){
  const r = await fetch(API + "/login",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      username: document.getElementById("lu").value,
      password: document.getElementById("lp").value
    })
  });
  const d = await r.json();

  if(d.success){
    // ✅ STEP 3: redirect
    window.location.href = "home.html";
  }else{
    document.getElementById("lm").innerText = "Invalid Login";
  }
}

async function signup(){
  const r = await fetch(API + "/signup",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      username: document.getElementById("su").value,
      password: document.getElementById("sp").value
    })
  });
  const d = await r.json();
  document.getElementById("sm").innerText =
    d.success ? "Account Created" : "Signup Failed";
}

async function forgot(){
  await fetch(API + "/forgot-password",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      username: document.getElementById("fu").value
    })
  });
  document.getElementById("fm").innerText =
    "Request sent to admin";
}
</script>

</body>
</html>
